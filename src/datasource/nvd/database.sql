PRAGMA journal_mode=WAL;

--
--  This file is part of cve-check-tool
--
-- Copyright Â© 2015-2016 Intel Corporation
--
-- cve-check-tool is free software; you can redistribute it and/or modify
-- it under the terms of the GNU General Public License as published by
-- the Free Software Foundation; either version 2 of the License, or
-- (at your option) any later version.
--

-- Construct main tables if they don't exist
CREATE TABLE IF NOT EXISTS CVE_IDS (HASH INTEGER UNIQUE PRIMARY KEY, ID VARCHAR(17), SUMMARY TEXT, SCORE TEXT, MODIFIED INTEGER, VECTOR TEXT);
CREATE TABLE IF NOT EXISTS PRODUCTS (HASH INTEGER UNIQUE PRIMARY KEY, VENDOR TEXT, PRODUCT TEXT);
CREATE TABLE IF NOT EXISTS VERSIONS (HASH INTEGER UNIQUE PRIMARY KEY, PRODUCT_ID INTEGER, CVE_ID INTEGER, VERSION TEXT);

-- We store our modification records here --
CREATE TABLE IF NOT EXISTS NVD_INDEXES (NVD_YEAR INTEGER UNIQUE PRIMARY KEY, MODIFIED INTEGER, CHECKED_LAST INTEGER);

-- Speed up secondary CVE inserts
CREATE INDEX IF NOT EXISTS CVE_MOD_IDX on CVE_IDS (HASH, MODIFIED);
